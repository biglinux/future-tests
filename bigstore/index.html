<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="css/beer.min.css" rel="stylesheet">
    <link href="css/biglinux.css" rel="stylesheet">
    <script src="js/alpine/cdn.min.js" defer></script>
    <script src="js/stonejs.js"></script>
    <script src="js/bigstore-search.js"></script>
    <script>window._ = Stone.gettext</script>
    <script type="module" src="js/beer.min.js"></script>
</head>

<body class="light large-text">
    <div x-data="getItems()" x-init="loadConfig">
        <header>
            <nav>
                <!-- Search bar -->
                <h5 class="max center-align">
                    <!-- Switches for search sources -->
                    <div>
                        <label class="switch">
                            <input type="checkbox" x-model="searchPacman" x-on:change="saveConfig">
                            <span>Pacman (<span x-text="pacmanCount"></span>)</span>
                        </label>
                        <label class="switch">
                            <input type="checkbox" x-model="searchAUR" x-on:change="saveConfig">
                            <span>AUR (<span x-text="aurCount"></span>)</span>
                        </label>
                        <label class="switch">
                            <input type="checkbox" x-model="searchFlatpak" x-on:change="saveConfig">
                            <span>Flatpak (<span x-text="flatpakCount"></span>)</span>
                        </label>
                        <label class="switch">
                            <input type="checkbox" x-model="searchSnap" x-on:change="saveConfig">
                            <span>Snap (<span x-text="snapCount"></span>)</span>
                        </label>
                    </div>
                    <div class="field large prefix round fill">
                        <i class="front">search</i>
                        <input @input.debounce.350ms="filterAutocomplete" x-ref="searchInput"
                            x-on:keyup.enter="performSearch" placeholder="Search...">
                        <menu class="min" x-show="autocompleteResults.length > 0"
                            style="max-height: 200px; overflow-y: auto;">
                            <template x-for="result in autocompleteResults">
                                <a class="row" x-on:click="selectAutocomplete(result.p)">
                                    <div x-text="result.p + '  -  ' + result.s"></div>
                                </a>
                            </template>
                        </menu>
                    </div>
                </h5>
            </nav>
        </header>

        <!-- Grid of items -->
        <div class="center-align">
            <div class="center-align" x-ref="scrollContainer">
                <template x-for="item in displayedItems" class="grid">
                    <a x-on:click="_run(item.exec)" class="medium-margin medium-width">
                        <article class="round medium-width small-height">
                            <div class="row">
                                <span x-text="item.s" class="badge border round">Type</span>
                                <div x-bind:x-on:load="fetchIcon(item)" x-ref="itemContainer" x-html="item.iconHTML">
                                    Icon</div>
                                <div>
                                    <h5 class="small" x-text="formatTitle(item.p)"></h5>
                                    <p class="left-align" x-text="item.v">Version</p>
                                </div>
                            </div>
                            <p x-text="formatDescription(item.d)" class="left-align"></p>
                            <p x-text="item.i === 'true' ? 'Remover' : 'Instalar'">Installed</p>
            </div>
            </article>
            </a>
            </template>
            <div class="center-align" x-show="search !== '' && endOfResults && displayedItems.length > 0">
                <p>End of Results</p>
            </div>

            <div class="center-align" x-show="search !== '' && displayedItems.length === 0">
                <p>Nenhum resultado</p>
            </div>

            <div id="infinite-scroll-trigger"></div>
        </div>
    </div>

    <label class="switch icon large-margin fixed bottom right">
        <a class="circle small secondary"
            onclick="ui('mode', ui('mode') == 'dark' ? 'light' : 'dark')"><i>dark_mode</i></a>
    </label>
    </div>